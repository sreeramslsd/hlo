<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Midday Meal Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap" rel="stylesheet" />
  <style>
    body {
      font-family: 'Montserrat', sans-serif;
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: #f0f4f8;
      min-height: 100vh;
      margin: 0;
      padding: 2rem 1rem;
    }
.container {
  max-width: 960px;
  margin: auto;
  background: rgba(255, 255, 255, 0.15); /* transparent, no blur */
  padding: 2.5rem 3rem;
  border-radius: 2rem;
  box-shadow: 0 4px 60px 1px rgba(0,0,0,0.15);
}

    h1 {
      font-weight: 700;
      font-size: 2.8rem;
      margin-bottom: 0.5rem;
      color: #01040dff;
      text-shadow: 0 0 8px #9da6fd;
      text-align: center;
    }
    .header-subtitle {
      text-align: center;
      font-weight: 500;
      font-size: 1.2rem;
      margin-bottom: 2rem;
      color: black;
    }
    .stats-row {
      display: flex;
      gap: 2rem;
      justify-content: center;
      margin-bottom: 2rem;
      flex-wrap: wrap;
    }
    .stat-card {
      flex: 1 1 180px;
      background: #2d365e;
      border-radius: 1rem;
      padding: 1.5rem 1.8rem;
      text-align: center;
      box-shadow: 0 0 20px #5f7cec44;
      transition: box-shadow 0.4s ease;
    }
    .stat-card:hover {
      box-shadow: 0 0 35px #9da6fd88;
    }
    .stat-value {
      font-size: 3rem;
      font-weight: 700;
      color: #a5b4fc;
      margin-bottom: 0.2rem;
      letter-spacing: 1px;
    }
    .stat-label {
      font-size: 1.1rem;
      font-weight: 600;
      color: #cbd5e1cc;
    }
    .meal-section {
      background: #21294f;
      border-radius: 1.8rem;
      padding: 2rem 3rem;
      margin-bottom: 3rem;
      box-shadow: 0 0 30px #4b59f7aa;
      text-align: center;
    }
    .meal-day {
      font-size: 1.6rem;
      font-weight: 700;
      color: #d7dbfe;
      margin-bottom: 0.8rem;
      text-shadow: 0 0 6px #6a7cff;
    }
    .meal-menu {
      font-size: 1.3rem;
      font-weight: 500;
      color: #a5b4fc;
      margin-bottom: 1.5rem;
      min-height: 65px;
    }
    .meal-tags {
      display: flex;
      justify-content: center;
      gap: 0.8rem;
      flex-wrap: wrap;
    }
    .meal-tag {
      padding: 0.3rem 1rem;
      background: linear-gradient(135deg, #6c72ff, #2cb1bc);
      border-radius: 9999px;
      color: #fff;
      font-weight: 600;
      font-size: 0.9rem;
      user-select: none;
      box-shadow: 0 0 12px #66b0deaa;
      transition: background 0.3s ease;
    }
    .meal-tag:hover {
      background: linear-gradient(135deg, #2cb1bc, #6c72ff);
      cursor: default;
    }
    .analytics-chart {
      margin-top: 3rem;
    }
    canvas {
      max-width: 100% !important;
      height: auto !important;
      border-radius: 1.5rem;
      box-shadow: 0 0 20px #4b59f7aa;
      background: #1c244d;
    }
    /* Responsive */
    @media (max-width: 768px) {
      .stats-row {
        flex-direction: column;
        align-items: center;
      }
      .stat-card {
        width: 90%;
      }
      .meal-section {
        padding: 1.5rem 1.5rem;
      }
    }
  </style>

<style>
    body {
        margin: 0;
        padding: 0;
        background: url("{{ url_for('static', filename='images/cartoon-school-kids-raising-hand-in-classroom-vector-22718057.webp') }}") 
                    no-repeat center center fixed;
        background-size: cover;
        font-family: Arial, sans-serif;
    }
</style>


</head>
<body>
  <div class="container">
    <h1>Mid-Day Meal Dashboard</h1>
    <p class="header-subtitle">Date: {{ today_str }}, {{ today_full_str }}</p>


    <div class="stats-row">
      <div class="stat-card">
        <div class="stat-value">{{ total_students }}</div>
        <div class="stat-label">Total Students</div>
      </div>
      <div class="stat-card">
        <div class="stat-value">{{ present_students }}</div>
        <div class="stat-label">Present Today</div>
      </div>
      <div class="stat-card">
        <div class="stat-value">{{ absent_students }}</div>
        <div class="stat-label">Absent</div>
      </div>
      <div class="stat-card">
        <div class="stat-value">{{ attendance_percent }}%</div>
        <div class="stat-label">Attendance Rate</div>
      </div>
  <div class="meal-section">
  <div class="meal-day">Today's Meal: {{ today_meal.meal }}</div>
  <div class="meal-tags">
    {% for tag in today_meal.tags %}
      <div class="meal-tag">{{ tag }}</div>
    {% endfor %}
  </div>
  <p style="margin-top: 1rem;">Estimated Meal Requirement Based on Attendance:</p>
  <p>Dal Needed: <strong>{{ dal_needed_kg }} kg</strong></p>
  <p>Rice Needed: <strong>{{ rice_needed_kg }} kg</strong></p>

  <hr style="border-color: #999; margin: 2rem 0;" />
  <div style="text-align:center; color:#fff; font-weight: 700; font-size: 1.3rem;">
    <div>Today's Attendance: {{ present_students }} / {{ total_students }}</div>
    <div>Attendance Percentage: {{ attendance_percent }}%</div>
  </div>
</div>



<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  const ctx = document.getElementById('attendanceChart').getContext('2d');
  const attendanceChart = new Chart(ctx, {
    type: 'line',
    data: {
      labels: {{ dates | tojson }},
      datasets: [{
        label: 'Attendance (Last 7 Days)',
        data: {{ counts | tojson }},
        fill: false,
        borderColor: '#6c72ff',
        backgroundColor: '#6c72ff',
        tension: 0.25,
        pointRadius: 6,
        pointBackgroundColor: '#2cb1bc'
      }]
    },
    options: {
      scales: {
        y: {
          beginAtZero: true,
          max: {{ total_students }},
          stepSize: 1,
          grid: {
            drawBorder: false,
            color: '#e0e7ff22'
          },
          ticks: {
            color: '#a5b4fc'
          }
        },
        x: {
          grid: {
            drawBorder: false,
            color: '#e0e7ff22'
          },
          ticks: {
            color: '#a5b4fc'
          }
        }
      },
      plugins: {
        legend: {
          labels: {
            color: '#cbd5e1'
          }
        },
        tooltip: {
          backgroundColor: '#1c244d',
          titleColor: '#8ab4f8',
          bodyColor: '#cbd5e1',
          cornerRadius: 6
        }
      }
    }
  });
</script>
</body>
</html>
